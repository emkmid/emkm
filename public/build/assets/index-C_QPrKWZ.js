import{r as h,b as M,j as e,H as ee,L as I,a as z}from"./app-CKCinfFZ.js";import{A as se}from"./app-layout-DzlcKoE3.js";import{B as i}from"./button-CKcqXIK3.js";import{C as g,a as u,c as b,b as N,d as ae}from"./card-DS7sU3Zj.js";import{B as _}from"./badge-CSi1g2RN.js";import{I as le}from"./input-Cv05gOWN.js";import{T as te,a as ie,b as A,c as D,d as ne,e as T}from"./table-D2TKR52N.js";import{D as P,a as H,b as O,c as U,d as $,e as K}from"./dialog-Ox7d9jeD.js";import{P as re}from"./plus-nIBTTfPk.js";import{c as ce}from"./createLucideIcon-zm2gQ1If.js";import{T as de}from"./trash-2-DjaORZ7M.js";import{S as R}from"./save-uH9t__fz.js";import{L}from"./loader-circle-BqVIgACv.js";import{C as B}from"./circle-check-ezXGJe1t.js";import{C as V}from"./circle-x-BwbvH1fU.js";import{X as oe}from"./index-BK5_uL61.js";import"./index-B3DM7Jyq.js";import"./index-YQV78XoV.js";import"./index-SDKuaDNM.js";import"./index-Dcf7jzsj.js";import"./index-DYBwkXJz.js";import"./book-open-DJVO7zTz.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],xe=ce("Pencil",me),he=({checked:n,onCheckedChange:p,disabled:r})=>e.jsx("button",{type:"button",role:"switch","aria-checked":n,disabled:r,onClick:()=>p(!n),className:`
            relative inline-flex h-6 w-11 items-center rounded-full transition-colors
            ${n?"bg-primary":"bg-gray-200"}
            ${r?"opacity-50 cursor-not-allowed":"cursor-pointer"}
        `,children:e.jsx("span",{className:`
                inline-block h-4 w-4 transform rounded-full bg-white transition-transform
                ${n?"translate-x-6":"translate-x-1"}
            `})});function Pe({packages:n,features:p,featureMatrix:r}){const[l,w]=h.useState(null),[x,f]=h.useState(""),[c,k]=h.useState(!1),[d,F]=h.useState(!1),[S,v]=h.useState(null),[X,y]=h.useState(!1),{flash:o}=M().props,E={accounting:"bg-blue-100 text-blue-800",articles:"bg-purple-100 text-purple-800",invoices:"bg-green-100 text-green-800",customers:"bg-orange-100 text-orange-800",others:"bg-gray-100 text-gray-800"},G=(a,t,s)=>{var m;const C=r[a].feature;w({featureId:a,packageId:t,limit:s}),k((s==null?void 0:s.is_enabled)??!1),C.limit_type==="numeric"?f(((m=s==null?void 0:s.numeric_limit)==null?void 0:m.toString())??""):f("")},Y=async()=>{if(!l)return;F(!0),y(!1);const a=r[l.featureId].feature,t={package_id:l.packageId,feature_id:l.featureId,is_enabled:c,numeric_limit:a.limit_type==="numeric"&&x?parseInt(x):null,list_values:a.limit_type==="list"?x:null};z.post(route("admin.features.update-limit"),t,{preserveScroll:!0,onSuccess:()=>{w(null)},onFinish:()=>{F(!1)}})},q=()=>{y(!0)},J=()=>{w(null),f(""),k(!1)},Q=async a=>{z.delete(route("admin.features.destroy",a),{preserveScroll:!0,onFinish:()=>{v(null)}})},W=(a,t,s)=>{if((l==null?void 0:l.featureId)===a.id&&(l==null?void 0:l.packageId)===t)return e.jsxs("div",{className:"flex flex-col items-center gap-2 p-3 bg-blue-50 border-2 border-blue-300 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{checked:c,onCheckedChange:k,disabled:d}),e.jsx("span",{className:"text-xs font-medium",children:c?"Enabled":"Disabled"})]}),a.limit_type==="numeric"&&c&&e.jsx(le,{type:"number",value:x,onChange:Z=>f(Z.target.value),placeholder:"-1 = Unlimited",className:"w-32 h-8 text-center",disabled:d}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(i,{size:"sm",onClick:q,disabled:d,className:"h-7 px-2 bg-[#23BBB7] hover:bg-[#1a8f85]",children:d?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"h-3 w-3 mr-1 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"h-3 w-3 mr-1"}),"Save"]})}),e.jsxs(i,{size:"sm",variant:"outline",onClick:J,disabled:d,className:"h-7 px-2",children:[e.jsx(oe,{className:"h-3 w-3 mr-1"}),"Cancel"]})]})]});const m=(s==null?void 0:s.is_enabled)??!1,j=s==null?void 0:s.numeric_limit;return e.jsxs("div",{className:"flex flex-col items-center gap-2 cursor-pointer hover:bg-blue-50 p-3 rounded-lg transition-colors group",onClick:()=>G(a.id,t,s),children:[m?e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"h-6 w-6 text-green-600"}),a.limit_type==="numeric"&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900",children:j===null||j===-1?"∞":j}),e.jsx("div",{className:"text-xs text-gray-500",children:j===null||j===-1?"Unlimited":"limit"})]}),a.limit_type==="boolean"&&e.jsx("span",{className:"text-xs font-medium text-green-700",children:"Enabled"})]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"h-6 w-6 text-gray-400"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Disabled"})]}),e.jsx("div",{className:"text-xs text-blue-600 opacity-0 group-hover:opacity-100 transition-opacity",children:"Click to edit"})]})};return e.jsxs(se,{breadcrumbs:[{title:"Admin",href:route("admin.dashboard")},{title:"Features",href:route("admin.features.index")}],children:[e.jsx(ee,{title:"Package Features"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Package Features"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Kelola fitur dan batasan untuk setiap paket berlangganan"})]}),e.jsx(I,{href:route("admin.features.create"),children:e.jsxs(i,{size:"lg",children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Tambah Feature"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(g,{children:e.jsxs(u,{className:"pb-3",children:[e.jsx(b,{children:"Total Features"}),e.jsx(N,{className:"text-3xl",children:Object.values(p).flat().length})]})}),e.jsx(g,{children:e.jsxs(u,{className:"pb-3",children:[e.jsx(b,{children:"Categories"}),e.jsx(N,{className:"text-3xl",children:Object.keys(p).length})]})}),e.jsx(g,{children:e.jsxs(u,{className:"pb-3",children:[e.jsx(b,{children:"Active Packages"}),e.jsx(N,{className:"text-3xl",children:n.length})]})}),e.jsx(g,{children:e.jsxs(u,{className:"pb-3",children:[e.jsx(b,{children:"Total Limits"}),e.jsx(N,{className:"text-3xl",children:Object.values(r).reduce((a,t)=>a+Object.keys(t.limits).length,0)})]})})]}),e.jsxs(g,{children:[e.jsxs(u,{children:[e.jsx(N,{children:"Feature Matrix"}),e.jsx(b,{children:"Klik pada cell untuk edit limits. Toggle enable/disable dan atur numeric limits."})]}),e.jsx(ae,{className:"p-0",children:Object.entries(p).map(([a,t])=>e.jsxs("div",{className:"border-b last:border-b-0",children:[e.jsx("div",{className:"bg-gray-50 px-6 py-3 border-b",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_,{className:E[a]||E.others,children:a.toUpperCase()}),e.jsxs("span",{className:"text-sm text-gray-600",children:[t.length," features"]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(te,{children:[e.jsx(ie,{children:e.jsxs(A,{className:"bg-white",children:[e.jsx(D,{className:"w-[350px] font-semibold",children:"Feature"}),n.map(s=>e.jsx(D,{className:"text-center min-w-[160px]",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-bold text-base",children:s.name}),e.jsx("div",{className:"text-xs font-normal text-muted-foreground",children:s.price===0?"Gratis":`Rp ${s.price.toLocaleString("id-ID")}/bulan`})]})},s.id)),e.jsx(D,{className:"w-[120px] text-center",children:"Actions"})]})}),e.jsx(ne,{children:t.map(s=>{const C=r[s.id];return e.jsxs(A,{className:"hover:bg-gray-50",children:[e.jsx(T,{className:"align-top",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:s.feature_name}),e.jsx("div",{className:"text-xs text-gray-500 font-mono",children:s.feature_key})]}),s.description&&e.jsx("div",{className:"text-xs text-gray-600 leading-relaxed",children:s.description}),e.jsx(_,{variant:"outline",className:"text-xs",children:s.limit_type})]})}),n.map(m=>e.jsx(T,{className:"text-center align-top bg-white",children:W(s,m.id,C.limits[m.id])},m.id)),e.jsx(T,{className:"text-center align-top",children:e.jsxs("div",{className:"flex gap-1 justify-center",children:[e.jsx(I,{href:route("admin.features.edit",s.id),children:e.jsx(i,{size:"sm",variant:"ghost",title:"Edit",children:e.jsx(xe,{className:"h-4 w-4 text-blue-600"})})}),e.jsx(i,{size:"sm",variant:"ghost",onClick:()=>v(s.id),title:"Delete",children:e.jsx(de,{className:"h-4 w-4 text-red-600"})})]})})]},s.id)})})]})})]},a))})]}),e.jsx(P,{open:S!==null,onOpenChange:()=>v(null),children:e.jsxs(H,{children:[e.jsxs(O,{children:[e.jsx(U,{children:"Hapus Feature"}),e.jsx($,{children:"Apakah Anda yakin ingin menghapus feature ini? Tindakan ini tidak dapat dibatalkan."})]}),e.jsxs(K,{children:[e.jsx(i,{variant:"outline",onClick:()=>v(null),children:"Batal"}),e.jsx(i,{variant:"destructive",onClick:()=>S&&Q(S),children:"Hapus"})]})]})}),e.jsx(P,{open:X,onOpenChange:y,children:e.jsxs(H,{className:"sm:max-w-md",children:[e.jsxs(O,{children:[e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"h-5 w-5 text-[#23BBB7]"}),"Konfirmasi Perubahan"]}),e.jsx($,{children:"Apakah Anda yakin ingin menyimpan perubahan ini?"})]}),e.jsxs("div",{className:"space-y-3 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Status:"}),e.jsx(_,{variant:c?"default":"secondary",className:c?"bg-green-500":"",children:c?"Enabled":"Disabled"})]}),l&&r[l.featureId].feature.limit_type==="numeric"&&c&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Limit:"}),e.jsx("span",{className:"text-sm font-bold text-gray-900",children:x===""||x==="-1"?"∞ Unlimited":x})]})]}),e.jsxs(K,{className:"gap-2 sm:gap-0",children:[e.jsx(i,{variant:"outline",onClick:()=>y(!1),disabled:d,children:"Batal"}),e.jsx(i,{onClick:Y,disabled:d,className:"bg-[#23BBB7] hover:bg-[#1a8f85]",children:d?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"mr-2 h-4 w-4 animate-spin"}),"Menyimpan..."]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Ya, Simpan"]})})]})]})}),(o==null?void 0:o.success)&&e.jsx("div",{className:"fixed bottom-4 right-4 z-50 animate-in slide-in-from-bottom-5",children:e.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-800 px-4 py-3 rounded-lg shadow-lg flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:o.success})]})}),(o==null?void 0:o.error)&&e.jsx("div",{className:"fixed bottom-4 right-4 z-50 animate-in slide-in-from-bottom-5",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg shadow-lg flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5"}),e.jsx("span",{className:"font-medium",children:o.error})]})})]})]})}export{Pe as default};
