import{r as c,j as a,H as L,b as T}from"./app-D-1jSdSI.js";import{I as _}from"./input-rupiah-aVTh1OVJ.js";import{B as f}from"./button-BX5vcoFW.js";import{I as x}from"./input-DiYUhYA0.js";import{L as k}from"./label-An7xpi-6.js";import{S,a as P,b as B,c as I,d as m}from"./select-CiW1MXoh.js";import{A as z}from"./app-layout-DxUc60V4.js";import"./index-CT1RrOcz.js";import"./chevron-down-DqP3Xkv8.js";import"./createLucideIcon-CXriQM3u.js";import"./check-DxG39XLJ.js";import"./index-BwhnYNPZ.js";import"./index-HhnKTRnY.js";import"./index-BcvLEM1W.js";import"./calculator-BeykbKUx.js";const j=["Bahan Baku","Tenaga Kerja Langsung","Overhead Pabrik"],A=["pcs","kg","liter","meter","bungkus","unit"],C=30;function sa(){const[d,H]=c.useState("1"),[h,K]=c.useState(""),[v,b]=c.useState(30),[N,M]=c.useState(""),[s,p]=c.useState({});c.useEffect(()=>{const e={};j.forEach(t=>{e[t]=t==="Bahan Baku"?[{name:"",qty:0,unit:"pcs",price:0}]:[]}),p(e)},[]),c.useEffect(()=>{const t={makanan_berat:{info:"Rekomendasi: 100% – 200%",value:150},camilan:{info:"Rekomendasi: 150% – 300%",value:200},minuman:{info:"Rekomendasi: 200% – 400%",value:250},frozen:{info:"Rekomendasi: 30% – 100%",value:50},roti:{info:"Rekomendasi: 100% – 250%",value:150},catering:{info:"Rekomendasi: 50% – 150%",value:100}}[h];t&&(M(t.info),b(t.value))},[h]);const g=(e,t,r,i)=>{const n=[...s[e]];n[t]={...n[t],[r]:r==="price"||r==="qty"?Number(i):i},p({...s,[e]:n})},$=e=>{if(s[e].length>=C)return alert(`Maksimal ${C} item untuk ${e}`);const t=e==="Bahan Baku"?"pcs":e==="Tenaga Kerja Langsung"?"orang":"buah";p({...s,[e]:[...s[e],{name:"",qty:0,unit:t,price:0}]})},q=(e,t)=>{const r=[...s[e]];r.splice(t,1),p({...s,[e]:r})},R=()=>{if(!d||Number(d)<=0)return alert("Jumlah produksi harus diisi dan lebih dari 0");if(!h)return alert("Kategori harus dipilih");for(const l of j)for(let u=0;u<s[l].length;u++){const o=s[l][u];if(!o.name.trim())return alert(`Nama item pada ${l} ke-${u+1} harus diisi`);if(!o.qty||o.qty<=0)return alert(`Qty pada ${l} ke-${u+1} harus lebih dari 0`);if(!o.price||o.price<=0)return alert(`Harga pada ${l} ke-${u+1} harus lebih dari 0`);if(l==="Bahan Baku"&&!o.unit)return alert(`Satuan pada ${l} ke-${u+1} harus dipilih`)}const e=Number(d);if(isNaN(e)||e<=0||e>500)return alert("Jumlah produksi tidak valid (maks 500)");if(!s["Bahan Baku"]||s["Bahan Baku"].length===0)return alert("Mohon isi setidaknya satu bahan baku");let t=0;const r={};for(const l of j){const u=s[l].reduce((o,y)=>o+y.qty*y.price,0);r[l]=u,t+=u}const i=t/e,n=i*(1+v/100);localStorage.setItem("hpp_result",JSON.stringify({total:t,hppSatuan:i,hargaJual:n,ringkasan:r,jumlahProduksi:e})),T.visit("/dashboard/hpp/hasil")},F=()=>a.jsxs("div",{className:"mb-6",children:[a.jsx(k,{htmlFor:"jumlahProduksi",children:"Jumlah Unit Produksi (maksimal 500):"}),a.jsx(x,{id:"jumlahProduksi",type:"text",inputMode:"numeric",pattern:"[0-9]*",value:d,onChange:e=>H(e.target.value.replace(/\D/g,""))})]}),J=()=>j.map(e=>{var t;return a.jsxs("div",{className:"mb-6",children:[a.jsx("h2",{className:"form-label",children:e}),a.jsx("div",{className:"mb-2 space-y-2",children:(t=s[e])==null?void 0:t.map((r,i)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(x,{placeholder:"Nama Item",value:r.name,onChange:n=>g(e,i,"name",n.target.value),className:"w-48"}),a.jsx(x,{type:"number",placeholder:"Qty",min:0,value:r.qty===0?"":r.qty,onChange:n=>g(e,i,"qty",n.target.value),className:"w-24"}),e==="Bahan Baku"?a.jsxs(S,{value:r.unit,onValueChange:n=>g(e,i,"unit",n),children:[a.jsx(P,{className:"w-36",children:a.jsx(B,{placeholder:"Satuan"})}),a.jsx(I,{children:A.map(n=>a.jsx(m,{value:n,children:n},n))})]}):a.jsxs("span",{className:"text-sm text-gray-500",children:["/ ",e==="Tenaga Kerja Langsung"?"orang":"buah"]}),a.jsx(_,{value:r.price,onChange:n=>g(e,i,"price",n),className:"w-36"}),a.jsx(f,{type:"button",onClick:()=>q(e,i),variant:"destructive",children:"Hapus"})]},i))}),a.jsx(f,{type:"button",onClick:()=>$(e),children:"+ Tambah Item"})]},e)}),w=()=>a.jsxs("div",{className:"mb-6",children:[a.jsx(k,{children:"Kategori Produk:"}),a.jsxs(S,{value:h,onValueChange:K,children:[a.jsx(P,{children:a.jsx(B,{placeholder:"Pilih Kategori"})}),a.jsxs(I,{children:[a.jsx(m,{value:"makanan_berat",children:"Makanan Berat"}),a.jsx(m,{value:"camilan",children:"Camilan / Snack"}),a.jsx(m,{value:"minuman",children:"Minuman"}),a.jsx(m,{value:"frozen",children:"Frozen Food"}),a.jsx(m,{value:"roti",children:"Roti / Kue"}),a.jsx(m,{value:"catering",children:"Catering / Pesanan Khusus"})]})]}),N&&a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:N})]}),E=()=>a.jsxs("div",{className:"mb-6",children:[a.jsx(k,{children:"Markup (%):"}),a.jsx(x,{type:"number",value:v,onChange:e=>b(Number(e.target.value))})]});return a.jsxs(z,{children:[a.jsx(L,{title:"HPP"}),a.jsx("div",{className:"mx-auto max-w-5xl p-6",children:a.jsxs("div",{className:"card",children:[a.jsx("h1",{className:"mb-6 text-center text-2xl font-bold",children:"Form Perhitungan HPP Produk"}),F(),J(),w(),E(),a.jsx(f,{onClick:R,className:"bg-blue-500 text-white hover:bg-blue-600",children:"Hitung HPP & Harga Jual"})]})})]})}export{sa as default};
