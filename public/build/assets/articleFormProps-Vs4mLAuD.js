import{r as v,j as e,R as _,u as N,a as C}from"./app-BtQOPadY.js";import{I as h}from"./input-error-CmqPoni2.js";import{B as w}from"./button-kG5wWM0Y.js";import{C as E,d as R}from"./card-VW3GaBeo.js";import{I as b}from"./input-RoOpGOIp.js";import{L as p}from"./label-Cy_navKP.js";import"./index-vrIUAlqt.js";import"./index-bf5fs-Ob.js";const F=({id:s,value:j="",onChange:x,uploadUrl:a,placeholder:r,className:l})=>{const c=v.useRef(null);return v.useEffect(()=>{c.current.editor;const g=m=>{const n=m.target;x(n.value)},d=async m=>{var u;const n=m.attachment,f=n.file;if(!f)return;const t=new FormData;t.append("image",f);const i=await fetch(a,{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":((u=document.querySelector('meta[name="csrf-token"]'))==null?void 0:u.content)||"",Accept:"application/json"},body:t,credentials:"include"});if(i.ok){const o=await i.json();n.setAttributes({url:o.url,href:o.href})}else n.remove(),alert("Upload gagal.")};return document.addEventListener("trix-change",g),document.addEventListener("trix-attachment-add",d),()=>{document.removeEventListener("trix-change",g),document.removeEventListener("trix-attachment-add",d)}},[a,x]),e.jsxs("div",{className:l,children:[e.jsx("input",{id:s,type:"hidden",value:j,ref:c}),_.createElement("trix-editor",{input:s,placeholder:r||"Tulis artikel...",className:"trix-content min-h-40"})]})};function U({initialData:s={},submitUrl:j,method:x="post"}){const{data:a,setData:r,errors:l,processing:c,post:y,put:g}=N({title:s.title||"",excerpt:s.excerpt||"",content_html:s.content_html||"",published_at:s.published_at||"",thumbnail_path:null}),[d,m]=_.useState(s.thumbnail_path?`/storage/${s.thumbnail_path}`:null),n=t=>{t.preventDefault(),C.post(j,{...a,_method:x.toUpperCase()},{forceFormData:!0})},f=t=>{var u;const i=(u=t.target.files)==null?void 0:u[0];if(i){r("thumbnail_path",i);const o=new FileReader;o.onloadend=()=>m(o.result),o.readAsDataURL(i)}};return e.jsx(E,{children:e.jsx(R,{children:e.jsxs("form",{onSubmit:n,className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2 md:flex-row",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(p,{htmlFor:"title",children:"Judul"}),e.jsx(b,{id:"title",value:a.title,onChange:t=>r("title",t.target.value)}),e.jsx(h,{message:l.title})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(p,{htmlFor:"published_at",children:"Publikasi"}),e.jsx(b,{id:"published_at",type:"datetime-local",value:a.published_at||"",onChange:t=>r("published_at",t.target.value)}),e.jsx(h,{message:l.published_at})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(p,{htmlFor:"excerpt",children:"Ringkasan"}),e.jsx(b,{id:"excerpt",value:a.excerpt,onChange:t=>r("excerpt",t.target.value)}),e.jsx(h,{message:l.excerpt})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(p,{children:"Konten"}),e.jsx(F,{id:"article-content",value:a.content_html,onChange:t=>r("content_html",t),uploadUrl:route("articles.upload")}),e.jsx(h,{message:l.content_html})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(p,{htmlFor:"thumbnail",children:"Thumbnail"}),e.jsx("div",{className:"flex w-full items-center justify-center",children:e.jsxs("label",{className:"flex h-64 w-full cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 hover:bg-gray-100",children:[d?e.jsx("img",{src:d,alt:"Thumbnail Preview",className:"h-full w-full rounded-lg object-cover"}):e.jsx("div",{className:"flex flex-col items-center justify-center pt-5 pb-6 text-gray-500",children:e.jsx("p",{children:"Click to upload or drag and drop"})}),e.jsx("input",{id:"thumbnail_path",name:"thumbnail_path",type:"file",className:"hidden",onChange:f})]})}),e.jsx(h,{message:l.thumbnail_path})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(w,{type:"submit",disabled:c,children:c?"Menyimpan...":"Simpan"})})]})})})}export{U as default};
