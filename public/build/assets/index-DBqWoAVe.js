import{r as t,u as $,j as e,H as M,a as y}from"./app-L9aY0gQS.js";import{A as V}from"./app-layout-B1Xh9hn1.js";import{C,a as D,b as B,d as v,c as G}from"./card-Bc6ZZnNg.js";import{B as l}from"./button-Dv55gssn.js";import{A as h,b as u,c as p,d as j,e as g,f,g as k,h as b}from"./alert-dialog-CIphBLVs.js";import{I as K}from"./input-HwfAPBcO.js";import{L as X}from"./label-Bhd4719X.js";import{c as Y}from"./createLucideIcon-sJRutq3k.js";import{T as A}from"./triangle-alert-DVBaAlXE.js";import{D as q}from"./download-DrINpqZL.js";import{R as J}from"./refresh-cw-BSUzjwrf.js";import{T as Q}from"./trash-2-JGo1aDZv.js";import{C as U}from"./clock-ojZvcXVT.js";import{C as W}from"./circle-x-CD1cjoOH.js";import{C as Z}from"./circle-check-big-D7NB8Uai.js";import"./index-Cng_RkUA.js";import"./index-pYgDcjAm.js";import"./index-BzKPpDCx.js";import"./index-CEv2-ph2.js";import"./book-open-DEw8h3GV.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],S=Y("Database",ee),ae=[{title:"Admin Dashboard",href:"/dashboard/admin"},{title:"Backups",href:"/dashboard/admin/backups"}];function ye({backups:i}){const[R,d]=t.useState(!1),[T,c]=t.useState(!1),[I,o]=t.useState(!1),[s,r]=t.useState(null),[m,x]=t.useState(!1),{data:_,setData:w,post:z,processing:se}=$({description:""}),H=()=>{x(!0),z(route("admin.backups.create"),{onSuccess:()=>{d(!1),w("description",""),x(!1)},onError:()=>{x(!1)}})},E=a=>{window.location.href=route("admin.backups.download",a.id)},F=()=>{s&&y.post(route("admin.backups.restore",s.id),{},{onSuccess:()=>{c(!1),r(null)}})},L=()=>{s&&y.delete(route("admin.backups.destroy",s.id),{onSuccess:()=>{o(!1),r(null)}})},N=a=>new Date(a).toLocaleString("id-ID",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),O=a=>{switch(a){case"completed":return e.jsx(Z,{className:"h-5 w-5 text-green-600"});case"failed":return e.jsx(W,{className:"h-5 w-5 text-red-600"});case"pending":return e.jsx(U,{className:"h-5 w-5 text-yellow-600"});default:return null}},P=a=>{const n="inline-flex items-center rounded-full px-2 py-1 text-xs font-medium";switch(a){case"completed":return`${n} bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200`;case"failed":return`${n} bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200`;case"pending":return`${n} bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200`;default:return n}};return e.jsxs(V,{breadcrumbs:ae,children:[e.jsx(M,{title:"Database Backups"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Database Backups"}),e.jsx("p",{className:"text-muted-foreground",children:"Kelola backup database untuk keamanan data"})]}),e.jsxs(l,{onClick:()=>d(!0),children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"Buat Backup Baru"]})]}),e.jsxs(C,{className:"border-yellow-200 bg-yellow-50 dark:border-yellow-900 dark:bg-yellow-950",children:[e.jsx(D,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5 text-yellow-600"}),e.jsx(B,{className:"text-yellow-900 dark:text-yellow-100",children:"Peringatan"})]})}),e.jsx(v,{className:"text-sm text-yellow-800 dark:text-yellow-200",children:e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Backup database secara berkala untuk mencegah kehilangan data"}),e.jsx("li",{children:"Simpan file backup di tempat yang aman (download ke komputer lokal)"}),e.jsx("li",{children:"Restore database akan menimpa data yang ada saat ini"}),e.jsx("li",{children:"Pastikan tidak ada user yang aktif saat melakukan restore"})]})})]}),e.jsxs(C,{children:[e.jsxs(D,{children:[e.jsx(B,{children:"Daftar Backup"}),e.jsxs(G,{children:["Total ",i.total," backup tersedia"]})]}),e.jsx(v,{children:i.data.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(S,{className:"mx-auto h-12 w-12 text-muted-foreground"}),e.jsx("h3",{className:"mt-4 text-lg font-semibold",children:"Belum ada backup"}),e.jsx("p",{className:"text-muted-foreground",children:"Buat backup pertama Anda untuk mengamankan data"})]}):e.jsx("div",{className:"space-y-4",children:i.data.map(a=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[O(a.status),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-medium",children:a.filename}),e.jsx("span",{className:P(a.status),children:a.status})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:a.description||"No description"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Size: ",a.formatted_size]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Created: ",N(a.created_at)]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["By: ",a.creator.name]})]}),a.error_message&&e.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["Error: ",a.error_message]})]})]}),a.status==="completed"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>E(a),children:e.jsx(q,{className:"h-4 w-4"})}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>{r(a),c(!0)},children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>{r(a),o(!0)},children:e.jsx(Q,{className:"h-4 w-4 text-red-600"})})]})]},a.id))})})]})]}),e.jsx(h,{open:R,onOpenChange:d,children:e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsx(j,{children:"Buat Backup Database"}),e.jsx(g,{children:"Backup akan mencakup seluruh database. Proses ini mungkin memakan waktu beberapa menit."})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(X,{htmlFor:"description",children:"Deskripsi (Optional)"}),e.jsx(K,{id:"description",placeholder:"Contoh: Backup sebelum update besar",value:_.description,onChange:a=>w("description",a.target.value)})]})}),e.jsxs(f,{children:[e.jsx(k,{disabled:m,children:"Cancel"}),e.jsx(b,{onClick:H,disabled:m,children:m?"Creating...":"Buat Backup"})]})]})}),e.jsx(h,{open:T,onOpenChange:c,children:e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"h-5 w-5 text-red-600"}),"Restore Database"]}),e.jsxs(g,{children:[e.jsx("strong",{className:"text-red-600",children:"PERINGATAN:"})," Tindakan ini akan menimpa database yang ada dengan data dari backup. Semua perubahan yang dibuat setelah backup ini akan hilang.",e.jsx("br",{}),e.jsx("br",{}),"Backup yang akan di-restore: ",e.jsx("strong",{children:s==null?void 0:s.filename}),e.jsx("br",{}),"Dibuat: ",e.jsx("strong",{children:s&&N(s.created_at)})]})]}),e.jsxs(f,{children:[e.jsx(k,{children:"Cancel"}),e.jsx(b,{onClick:F,className:"bg-red-600 hover:bg-red-700",children:"Ya, Restore Database"})]})]})}),e.jsx(h,{open:I,onOpenChange:o,children:e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsx(j,{children:"Hapus Backup"}),e.jsxs(g,{children:["Apakah Anda yakin ingin menghapus backup ini? File backup akan dihapus permanent dan tidak dapat dikembalikan.",e.jsx("br",{}),e.jsx("br",{}),"File: ",e.jsx("strong",{children:s==null?void 0:s.filename})]})]}),e.jsxs(f,{children:[e.jsx(k,{children:"Cancel"}),e.jsx(b,{onClick:L,className:"bg-red-600 hover:bg-red-700",children:"Hapus"})]})]})})]})}export{ye as default};
