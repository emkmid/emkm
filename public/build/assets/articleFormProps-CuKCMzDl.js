import{r as _,j as e,U as y,u as N,b as C}from"./app-CBa2pIk9.js";import{I as m}from"./input-error-BSB1LxBf.js";import{B as w}from"./button-DSQHZldZ.js";import{C as E,d as F}from"./card-Dw5r5cDE.js";import{I as g}from"./input-Bnk__x_3.js";import{L as u}from"./label-DxW7TPMC.js";import"./index-B-ZAGOzB.js";const R=({id:s,value:f="",onChange:h,uploadUrl:a,placeholder:l,className:r})=>{const c=_.useRef(null);return _.useEffect(()=>{c.current.editor;const p=o=>{const t=o.target;h(t.value)},x=async o=>{var b;const t=o.attachment,n=t.file;if(!n)return;const d=new FormData;d.append("image",n);const i=await fetch(a,{method:"POST",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":((b=document.querySelector('meta[name="csrf-token"]'))==null?void 0:b.content)||"",Accept:"application/json"},body:d,credentials:"include"});if(i.ok){const v=await i.json();t.setAttributes({url:v.url,href:v.href})}else t.remove(),alert("Upload gagal.")};return document.addEventListener("trix-change",p),document.addEventListener("trix-attachment-add",x),()=>{document.removeEventListener("trix-change",p),document.removeEventListener("trix-attachment-add",x)}},[a,h]),e.jsxs("div",{className:r,children:[e.jsx("input",{id:s,type:"hidden",value:f,ref:c}),y.createElement("trix-editor",{input:s,placeholder:l||"Tulis artikel...",className:"trix-content min-h-40"})]})};function U({initialData:s={},submitUrl:f,method:h="post"}){const{data:a,setData:l,errors:r,processing:c}=N({title:s.title||"",excerpt:s.excerpt||"",content_html:s.content_html||"",published_at:s.published_at||"",thumbnail_path:null}),[j,p]=y.useState(s.thumbnail_path?`/storage/${s.thumbnail_path}`:null),x=t=>{t.preventDefault(),C.post(f,{...a,_method:h.toUpperCase()},{forceFormData:!0})},o=t=>{var d;const n=(d=t.target.files)==null?void 0:d[0];if(n){l("thumbnail_path",n);const i=new FileReader;i.onloadend=()=>p(i.result),i.readAsDataURL(n)}};return e.jsx(E,{children:e.jsx(F,{children:e.jsxs("form",{onSubmit:x,className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2 md:flex-row",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(u,{htmlFor:"title",children:"Judul"}),e.jsx(g,{id:"title",value:a.title,onChange:t=>l("title",t.target.value)}),e.jsx(m,{message:r.title})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(u,{htmlFor:"published_at",children:"Publikasi"}),e.jsx(g,{id:"published_at",type:"datetime-local",value:a.published_at||"",onChange:t=>l("published_at",t.target.value)}),e.jsx(m,{message:r.published_at})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(u,{htmlFor:"excerpt",children:"Ringkasan"}),e.jsx(g,{id:"excerpt",value:a.excerpt,onChange:t=>l("excerpt",t.target.value)}),e.jsx(m,{message:r.excerpt})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(u,{children:"Konten"}),e.jsx(R,{id:"article-content",value:a.content_html,onChange:t=>l("content_html",t),uploadUrl:route("articles.upload")}),e.jsx(m,{message:r.content_html})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(u,{htmlFor:"thumbnail",children:"Thumbnail"}),e.jsx("div",{className:"flex w-full items-center justify-center",children:e.jsxs("label",{className:"flex h-64 w-full cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed border-gray-300 bg-gray-50 hover:bg-gray-100",children:[j?e.jsx("img",{src:j,alt:"Thumbnail Preview",className:"h-full w-full rounded-lg object-cover"}):e.jsx("div",{className:"flex flex-col items-center justify-center pt-5 pb-6 text-gray-500",children:e.jsx("p",{children:"Click to upload or drag and drop"})}),e.jsx("input",{id:"thumbnail_path",name:"thumbnail_path",type:"file",className:"hidden",onChange:o})]})}),e.jsx(m,{message:r.thumbnail_path})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(w,{type:"submit",disabled:c,children:c?"Menyimpan...":"Simpan"})})]})})})}export{U as default};
